<!DOCTYPE html><html lang="zh-cmn-Hans" prefix="og: http://ogp.me/ns#" class="han-init"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /><title>MachineLearning｜2. Linear Regression &mdash; Xinyi He</title><link rel="stylesheet" href="https://buliangzhang24.github.io/assets/vendor/primer-css/css/primer.css"><link rel="stylesheet" href="https://buliangzhang24.github.io/assets/css/components/collection.css"><link rel="stylesheet" href="https://buliangzhang24.github.io/assets/css/components/repo-card.css"><link rel="stylesheet" href="https://buliangzhang24.github.io/assets/css/sections/repo-list.css"><link rel="stylesheet" href="https://buliangzhang24.github.io/assets/css/components/boxed-group.css"><link rel="stylesheet" href="https://buliangzhang24.github.io/assets/css/globals/common.css"><link rel="stylesheet" href="https://buliangzhang24.github.io/assets/css/globals/responsive.css"><link rel="stylesheet" href="https://buliangzhang24.github.io/assets/css/posts/index.css"><link rel="stylesheet" href="https://buliangzhang24.github.io/assets/vendor/octicons/octicons/octicons.css"><link rel="stylesheet" href="https://mazhuang.org/rouge-themes/dist/github.css"><link rel="canonical" href="https://buliangzhang24.github.io/2024/02/03/MachineLearning-2.-Linear-Regression/"><link rel="alternate" type="application/atom+xml" title="Xinyi He" href="https://buliangzhang24.github.io/feed.xml"><link rel="shortcut icon" href="https://buliangzhang24.github.io/favicon.ico"><meta property="og:title" content="MachineLearning｜2. Linear Regression"><meta name="keywords" content="Linear Regression"><meta name="og:keywords" content="Linear Regression"><meta name="description" content="Simple linear regressionassume a model : (Y≈β_0+β_1X)β ̂0interceptβ ̂1 slopeGiven some estimates β ̂0 and β ̂1, we can predict future salesy ̂=β ̂0+β ̂1x"><meta name="og:description" content="Simple linear regressionassume a model : (Y≈β_0+β_1X)β ̂0interceptβ ̂1 slopeGiven some estimates β ̂0 and β ̂1, we can predict future salesy ̂=β ̂0+β ̂1x"><meta property="og:url" content="https://buliangzhang24.github.io/2024/02/03/MachineLearning-2.-Linear-Regression/"><meta property="og:site_name" content="Xinyi He"><meta property="og:type" content="article"><meta property="og:locale" content="zh_CN" /><meta property="article:published_time" content="2024-02-03"> <script src="https://buliangzhang24.github.io/assets/vendor/jquery/dist/jquery.min.js"></script> <script src="https://buliangzhang24.github.io/assets/js/main.js"></script></head><body class="" data-mz=""><header class="site-header"><div class="container"><h1><a href="https://buliangzhang24.github.io/" title="Xinyi He"><span class="octicon octicon-mark-github"></span> Xinyi He</a></h1><button class="collapsed mobile-visible" type="button" onclick="toggleMenu();"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button><nav class="site-header-nav" role="navigation"> <a href="https://buliangzhang24.github.io/" class="site-header-nav-item" target="" title="Home">Home</a> <a href="https://buliangzhang24.github.io/categories/" class="site-header-nav-item" target="" title="Categories">Categories</a> <a href="https://buliangzhang24.github.io/archives/" class="mobile-hidden site-header-nav-item" target="" title="Archives">Archives</a> <a href="https://buliangzhang24.github.io/fragments/" class="site-header-nav-item" target="" title="Fragments">Fragments</a> <a href="https://buliangzhang24.github.io/wiki/" class="site-header-nav-item" target="" title="Projects">Projects</a> <a href="https://buliangzhang24.github.io/links/" class="mobile-hidden site-header-nav-item" target="" title="Useful Links">Useful Links</a> <a href="https://buliangzhang24.github.io/about/" class="site-header-nav-item" target="" title="About">About</a> <a class="mobile-hidden" href="https://buliangzhang24.github.io/feed.xml"><span class="octicon octicon-rss" style="color:orange;"></span></a></nav></div></header><section class="collection-head small geopattern" data-pattern-id="MachineLearning"><div class="container"><div class="columns"><div class="column three-fourths"><div class="collection-title"><h1 class="collection-header">MachineLearning｜2. Linear Regression</h1><div class="collection-info"> <span class="meta-info"> <span class="octicon octicon-calendar"></span> 2024/02/03 </span> <span class="meta-info"> <span class="octicon octicon-file-directory"></span> <a href="https://buliangzhang24.github.io/categories/#MachineLearning" title="MachineLearning">MachineLearning</a> </span> <span class="meta-info"> <span class="octicon octicon-clock"></span> 共 8164 字，约 24 分钟 </span></div></div></div><div class="column one-fourth mobile-hidden"><div class="collection-title"> <img style="height:72px;width:72px" src="https://buliangzhang24.github.io/assets/images/qrcode.jpg" alt="Buliangzhang" /></div></div></div></div></section><section class="container content"><div class="columns"><div class="column three-fourths" ><article class="article-content markdown-body"><h1 id="simple-linear-regression">Simple linear regression</h1><h2 id="assume-a-model--yβ_0β_1x">assume a model : (Y≈β_0+β_1X)</h2><p>β ̂0intercept β ̂1 slope Given some estimates β ̂0 and β ̂1, we can predict future sales y ̂=β ̂0+β ̂1x</p><p><em>regression: continous variable&gt; grwoth of crop(soil,country)</em> <em>classification: discrete</em></p><h3 id="estimation-of-the-coefficients">Estimation of the coefficients</h3><ol><li>the prediction for Y based on the ith value of X. (yi) ̂=β ̂0+β ̂1xi  </li><li>==residual== 残差 ei=y_i−(yi) ̂</li><li>We define the ==residual sum of squares (RSS) ==as RSS =e_1^2+e_2^2+…+e_n^2 RSS =(y1−β ̂0 −β ̂1x1)2+(y2−β ̂0 −β ̂1x2)2 +…+(yn−β ̂0 −β ̂1xn)2</li><li>Mean squared error: MSE=1/nRSS</li><li>==计算题==minimize the function: The least squares approach»minimize the residual sum of squares β ̂0 and β ̂1 such that the RSS is minimized. best possible line β ̂1=∑_i=1^n sum(x_i−x ̅)(y_i−y ̅)/∑_i=1^n sum(xi−x ̅)2 , β ̂0= y ̅−β ̂1x ̅, where y ̅=1/n∑_i=1^n sum yi and x ̅=1/n∑_i=1^n sum xi are the sample means. ==证明题== <strong>Exercise 6: Using, argue that in the case of simple linear regression, the least squares line always passes through the point mean x and mean y</strong><h2 id="the-residual-standard-error">The residual standard error</h2><ul><li>The approximate relationship: Y=β_0+β_1X+ε, Where ε is a mean-zero random error.</li></ul></li><li>The better the fit, the smaller the standard deviation of ε    σ =std (ε)= √RSS/(n−2)= ==RSE (the residual standard error)== 残差和的标准=残差标准差</li><li>这个可以再来计算standard errors of the coefficients（SE(β ̂0) and SE(β ̂1)）去确定这个prediction interval（预测区间=预测值±tα/2​×预测标准误差）</li><li>或者去计算confidence interval ：β ̂1±2∙SE(β ̂1)</li><li>最后 A 95% chance that the interval contains the true value of β1. [β ̂1−2∙SE(β ̂1), β ̂1+2∙SE(β ̂1)]<h2 id="model-uncertainty">Model Uncertainty</h2><h3 id="confidence-interval">Confidence Interval</h3><p>置信区间用于估计==参数==的不确定性范围</p><h3 id="prediction-interval">Prediction Interval</h3><p>预测区间用于估计未来==观测值==的不确定性范围。 ![[4112b79e66fc7ca74f309cc62257ffb.png]]</p><h2 id="hypothesis-testing">Hypothesis testing</h2><ul><li>描述 H_0:There is no relationship between X and Y versus the alternative hypothesis H_1: There is some relationship between X and Y</li><li>在数学上表示就是： H_0 : B1 = 0 就是slope=0 H_1 : B1 != 0 就是slope !=0</li><li>to test the null-hypothesis, we use ==t- statistic== t=β ̂1−0/SE(β ̂1)</li></ul><ul><li>p-value gives the probability of the null-hypothesis being true ==if p &lt;0.05, the 零假设 not likely to be true, so X 和Y has relationship==<ul><li>Assuming β1=0  (H_0), t follows a t-distribution with n−2 dof 当我们测试 β1​=0 这个假设时，我们计算得到一个 t 统计量，其分布遵循 t 分布，自由度为n−2。这个 t 统计量告诉我们在 β1​=0 假设成立的情况下，我们观察到的数据有多不寻常。</li></ul></li><li>t- distribution: 它类似于标准正态分布，但是它的尾部更加厚重，这使得 t 分布更适合于小样本情况下的推断</li><li>自由度： t 分布中的一个参数，它决定了 t 分布的形状<h3 id="assessing-the-accuracy-of-the-model">Assessing the accuracy of the model</h3></li></ul></li><li>RSE 越小越好</li><li>RSS</li><li>R-squared = 1- RSS/TSS (0-1) 越大越好 RSS=∑_i=1^n sum (yi−y ̂i)2 is the residual sum of squares TSS=∑_i=1^n sum (yi−y ̅)2 is the total sum of squares</li><li>R2 statistic vs correlation(r)<ul><li>R²仍然是用来衡量模型对因变量的变异性解释程度的指标</li><li>r相关系数通常用来衡量每个自变量与因变量之间的线性关系&gt;r^2是加权平方和</li><li>当p=1（only has one X ）: R^2=r^2 (only for simple linear regression, p=1)<h3 id="analysis">Analysis</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- The ==Residual standard error ==is a rough estimate for the standard deviation of ε, so, the standard deviation of the model prediction error. So in our advertisement example, the model will predict on average with an accuracy of 3.26 (thousand) sold units.==多少个==
- The ==R2== value indicates that 61.2% of the variance in the data set is explained by the model. ==多少占比== # Multiple linear regression
- 公式
- the definition of partial slope: We interpret βj as the average effect on Y of a one unit increase in Xj, holding all other predictors fixed. 
- two predictors (p= 2变量)&gt; 3D
- more predictors(p &gt; 2)&gt; hyperplane in p-D space
- 但是还想最小化这个点到面的距离，就是minimize RSS ## Correlation between regressors
- confounding variable  当单独TV，newspaper的时候，p value both &lt; 0.05, but when taking TV, newspaper and radio as the X variables together, the p value of newspaper &gt;0.05,因为newspaper 和radio相关，in other word, newspaper is confounding variable(混交变量) ## 1.Relationship between response and predictors ### F- statistic  就是跟t-statistic一样的 #### F=（(TSS−RSS)/p）/（RSS/(n−p−1)）
- F is high when ==RSS== is low   Better fitting model, higher F
- F compensates for number of independent variables p  F lower, when more variables used 
- F increases with the number of samples n ##### When F-statistic close to 1 , there is no relationship between the reponse and predictors
- If the linear model assumptions are correct: E{RSS/(n−p−1)}=σ^2
- If H_0 is true: E{(TSS−RSS)/p}=σ^2 ##### When H_1 is true, E{(TSS−RSS)/p}&gt;σ^2, F &gt; 1 ## 2. What are important variables? We would like to select the best predictors
</code></pre></div></div></li><li>Trying to ==compare all possible combinations== of models requires 2^p models to be built, including parameter estimation. For p=30, this means over a billion models.</li><li>To overcome computational capacity problems, some ==automated selection procedures== have been developed.<h3 id="selecting-the-best-modelfeatures">Selecting the best model/features</h3><h4 id="forward-selection">Forward Selection</h4><p>Begin with the ==null model==: Y=β_0 Try to ==add== one variable: Y=β_0+β_1X1, Y=β_0+β_2X2, Y=β_0+β_3X_3 Pick the one-variable model with ==lowest RSS == ==Repeat== to get best two-variable model ==Stop== when none of the remaining variables have a significant contribution就是当p大于0.05之后 ![[c5d6de717dd0a830e1a203b9a489a4b.png]]</p><h4 id="backward-selection">Backward selection</h4><p>Start with ==all variables== in the mode ==Remove variable== with ==the largest p-value== Fit new ==(p-1)-variable model== Remove ==next variable with largest p-value ==to get to (p-2)-variable ==Continue== until ==stopping rule== (largest p &lt; threshold)</p><h4 id="mixed">Mixed</h4><h2 id="3-how-well-does-the-model-fit-the-data">3. How well does the model fit the data?</h2><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- R^2:   &lt;mark class="hltr-grey"&gt;Portion&lt;/mark&gt; of explained variance in the data  Adding more variables will never reduce R2
- RSE（Residual Standard Error）：   RSE≈ standard deviation of ε   more parameters mean higher p which contribute to an increasing RSE  ## 4.How accurate are the predictions? Three causes of prediction uncertainty 
- ==The accuracy with which the βi can be estimated.== This is related to the &lt;mark class="hltr-grey"&gt;reducible error&lt;/mark&gt;, and is dependent on the type and amount of data
- ==The inherent model error. ==Not all processes are linear, so if we decide to choose a too simple model, there is &lt;mark class="hltr-grey"&gt;model bias.&lt;/mark&gt;
- ==The random error, ==modelled by ε. For each new experiment, some random error can be involved due to measurement noise, or some other unexplained variance source. This is the&lt;mark class="hltr-grey"&gt; irreducible error. &lt;/mark&gt; # Extension of the linear regression ## Qualitative predictors定性 #### dummy variables 虚拟变量来数学表示qualitative predictors ![[aa630840eb9582e024e6dab76da17ba.png]] #### Dummy variables for more than two levels ![[876895fdf570605c06a4816133f120c.png]] ## Interaction Terms #### Assumptions of linear regression model:
- ==Additive:== the influence of Xj on Y is independent of other variables
- ==Linear:== doubling the size of Xj will double its effect on Y. #### extra interaction Y=β_0+β_1X1+β_2X2X3+ε.  This model is not additive anymore, and ==nonlinear ==in the variables. However, it is still linear in the coefficients. ![[1dfdfa2e04eca48daef87646b149266.png]] ## Polynomial Regression/cubic Nonlinear relationships can be modelled by polynomial regression.
</code></pre></div></div></li></ul></li></ol><p><strong>Exercise 3</strong> ![[1b97c68e10e04809a6f393379ac4e32.png]] ![[7e4a6f9f8df493c378917222c8bc2ef.png]] <strong>False: Since the ocefficient for the GPA</strong> <strong>Exercise 4</strong> <strong>cubic and linear</strong> ![[b273348e912b8b8d7bdcf56877bdbc0.png]]</p><h1 id="inspecting-data-and-model可能会出现的问题">Inspecting data and model可能会出现的问题</h1><h2 id="1-nonlinearity非线性">1. Nonlinearity非线性</h2><p>==Residual plots== can be useful to identify nonlinearity of the data ![[ae13fe312232db06d2cc7175d7a039f.png]] ![[Pasted image 20240213191216.png]] 都是和intercept那个线来比较，来求距离。 ==The residuals ==ei=y_i−y ̂_1 of the linear fit (left) show a strong pattern. ==Quadratic fit ==(right) has more equally distributed residuals.</p><h2 id="2-correlation-of-error-terms相关性">2. Correlation of error terms相关性</h2><ul><li>两个independent variable之间有没有关系</li><li>==Important assumption==: for each observation j, the ==error terms εj are uncorrelated==. This assumption is not always true.</li><li><mark class="hltr-green">In time series data</mark>, residuals are often ==correlated==, which causes ==tracking== – adjacent residuals show similar values ![[c4a7a93844ec171584daf697fbb5d91.png]]<h2 id="3nonconstant-error-variance-异方差性">3.Nonconstant error variance: 异方差性</h2></li><li>Important assumption: constant variance Var(εi)=σ2  for all i.</li><li>This does not always hold true ：<mark class="hltr-green">heteroscedasticity</mark></li><li>A possible way to ==solve== this is by transformation of Y such as log⁡(Y) or √Y ![[531e4f7657a56e1634ecd3a7e0b6543.png]]<h2 id="4-outliers离群值">4. Outliers离群值</h2></li><li>==Outliers==: points yi that are far from the value predicted by the model</li><li>==Possible caused==: incorrect measurements or recordings</li><li>Outliers may ==cause ==RSE to increase, and R2 to decrease</li><li>Check for outliers visually: via residual plots</li><li>==Studentized residual==: t_i=ϵ_i/SE(ϵ_i)学生残差的计算方式是将残差除以一个标准误差的估计量，通常使用的标准误差是根据样本数据得到的回归模型的残差标准差.==就是另一种除法的标准残差==</li><li>Test statistically on outlier: |t_i|&gt;3<h2 id="5high-leverage-points高杠杆点">5.High leverage points高杠杆点</h2></li><li>High leverage points: ==unusual high or low x values== &gt; have much influence on estimated values of the coefficients</li><li>Leverage stats: ℎ_i=1/n+(x_i−x ̅)^2/∑_j=1^n▒(x_j−x ̅)^2</li><li>Average leverage =p+1/n</li><li>If ℎ_i≫p+1/n , a point is a ==high leverage point. ==<h2 id="6colinearitycorelation">6.Colinearity/corelation</h2></li><li>==Collinearity==: two or more predictors are closely related to each other</li><li>This may ==cause== high uncertainty in coefficient estimates</li></ul><h5 id="measuring-collinearity-variance-inflation-factor-vif-">Measuring collinearity: ==Variance Inflation Factor (VIF) ==</h5><ul><li><table><tbody><tr><td>VIF(βj)=1/1−R_X_j</td><td>X_−j^2大代表相关性高</td></tr></tbody></table></li><li><table><tbody><tr><td>with R_X_j</td><td>X_−j^2 the R2 from a ==regression of Xj  onto all other predictors.==</td></tr></tbody></table></li><li>VIF is high when X_j can be estimated well from other variables</li><li>==VIF(βj)&gt;5 or 10== is indicates problematic amount of collinearity</li><li>Action: remove predictor with largest VIF and perform analysis again for the simpler model</li><li>==VIF high, it can be moved one of them maybe==</li></ul><div style="margin-top:2em;padding:0 1.5em;border:1px solid #d3d3d3;background-color:#deebf7"><h3>文档信息</h3><ul><li>本文作者：<a href="https://buliangzhang24.github.io" target="_blank">Xinyi He</a></li><li>本文链接：<a href="https://buliangzhang24.github.io/2024/02/03/MachineLearning-2.-Linear-Regression/" target="_blank">https://buliangzhang24.github.io/2024/02/03/MachineLearning-2.-Linear-Regression/</a></li><li>版权声明：自由转载-非商用-非衍生-保持署名（<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh" target="_blank">创意共享3.0许可证</a>）</li></ul></div></article><div class="share"></div><div class="comment"> <script src="https://giscus.app/client.js" data-repo="Buliangzhang24/Buliangzhang24.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnk5MzEyNzkxNw==" data-category="Announcements" data-category-id="DIC_kwDOBY0E7c4CRtg9" data-mapping="title" data-strict="1" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous" async> </script></div></div><div class="column one-fourth"><h3>Search</h3><div id="site_search"> <input style="width:96%" type="text" id="search_box" placeholder="Search"></div><ul id="search_results" style="font-size:14px;list-style-type:none;padding-top:10px;padding-left:10px;"></ul><script src="https://buliangzhang24.github.io/assets/js/simple-jekyll-search.min.js"></script> <script type="text/javascript"> SimpleJekyllSearch({ searchInput: document.getElementById('search_box'), resultsContainer: document.getElementById('search_results'), json: 'https://buliangzhang24.github.io/assets/search_data.json?v=1727728241', searchResultTemplate: '<li><a href="{url}" title="{title}">{title}</a></li>', noResultsText: 'No results found', limit: 10, fuzzy: false, exclude: ['Welcome'] }) </script><h3 class="post-directory-title mobile-hidden">Table of Contents</h3><div id="post-directory-module" class="mobile-hidden"><section class="post-directory"><dl></dl></section></div><script src="https://buliangzhang24.github.io/assets/js/jquery.toc.js"></script></div></div></section><footer class="container"><div class="site-footer" role="contentinfo"><div class="copyright left mobile-block"> © 2024 <span title="Xinyi He">Xinyi He</span> <a href="javascript:window.scrollTo(0,0)" class="right mobile-visible">TOP</a></div><ul class="site-footer-links right mobile-hidden"><li> <a href="javascript:window.scrollTo(0,0)" >TOP</a></li></ul><a href="https://github.com/Buliangzhang24/Buliangzhang24.github.io" target="_blank" aria-label="view source code"> <span class="mega-octicon octicon-mark-github" title="GitHub"></span> </a><ul class="site-footer-links mobile-hidden"><li> <a href="https://buliangzhang24.github.io/" title="Home" target="">Home</a></li><li> <a href="https://buliangzhang24.github.io/categories/" title="Categories" target="">Categories</a></li><li> <a href="https://buliangzhang24.github.io/archives/" title="Archives" target="">Archives</a></li><li> <a href="https://buliangzhang24.github.io/fragments/" title="Fragments" target="">Fragments</a></li><li> <a href="https://buliangzhang24.github.io/wiki/" title="Projects" target="">Projects</a></li><li> <a href="https://buliangzhang24.github.io/links/" title="Useful Links" target="">Useful Links</a></li><li> <a href="https://buliangzhang24.github.io/about/" title="About" target="">About</a></li><li><a href="https://buliangzhang24.github.io/feed.xml"><span class="octicon octicon-rss" style="color:orange;"></span></a></li></ul></div></footer><div class="tools-wrapper"> <a class="gotop" href="#" title="回到顶部"><span class="octicon octicon-arrow-up"></span></a></div><script src="https://buliangzhang24.github.io/assets/js/geopattern.js"></script> <script> jQuery(document).ready(function($) { $('.geopattern').each(function(){ $(this).geopattern($(this).data('pattern-id')); }); /* hljs.initHighlightingOnLoad(); */ }); </script></body></html>
